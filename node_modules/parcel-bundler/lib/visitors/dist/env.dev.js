"use strict";

var types = require('@babel/types');

module.exports = {
  MemberExpression: function MemberExpression(node, asset) {
    // Inline environment variables accessed on process.env
    if (types.matchesPattern(node.object, 'process.env')) {
      var key = types.toComputedKey(node);

      if (types.isStringLiteral(key)) {
        var prop = process.env[key.value];

        if (typeof prop !== 'function') {
          var value = types.valueToNode(prop);
          morph(node, value);
          asset.isAstDirty = true;
          asset.cacheData.env[key.value] = process.env[key.value];
        }
      }
    }
  }
}; // replace object properties

function morph(object, newProperties) {
  for (var key in object) {
    delete object[key];
  }

  for (var _key in newProperties) {
    object[_key] = newProperties[_key];
  }
}