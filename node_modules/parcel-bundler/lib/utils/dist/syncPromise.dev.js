"use strict";

var deasync = require('deasync');
/**
 * Synchronously waits for a promise to return by
 * yielding to the node event loop as needed.
 */


function syncPromise(promise) {
  var isDone = false;
  var res, err;
  promise.then(function (value) {
    res = value;
    isDone = true;
  }, function (error) {
    err = error;
    isDone = true;
  });
  deasync.loopWhile(function () {
    return !isDone;
  });

  if (err) {
    throw err;
  }

  return res;
}

module.exports = syncPromise;